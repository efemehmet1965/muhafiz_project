{
  "Mode": "Silent",

  "WatchedPaths": [
    "%USERPROFILE%/Downloads",
    "%USERPROFILE%/Desktop"
  ],

  "ProcessWhitelist": [
    "explorer.exe",
    "svchost.exe"
  ],

  "Ioc": {
    "HashesPath": "%PROGRAMDATA%/Muhafiz/ioc/hashes.json",
    "UrlsPath": "%PROGRAMDATA%/Muhafiz/ioc/urls.json"
  },

  "Yara": {
    "Enabled": true,
    "UseCli": true,
    "CliPath": "%PROGRAMDATA%/Muhafiz/yara/yara64.exe",
    "RulesPath": "%PROGRAMDATA%/Muhafiz/yara/rules"
  },

  "Egress": {
    "ConditionalWebhookBlock": true,
    "GlobalWebhookBlock": false,
    "IocBlockAlways": true,
    "RuleTtlSeconds": 60,
    "ApplyFirewall": false,
    "MaxIpsPerHost": 6,
    "DnsCacheSeconds": 600
  },

  "Quarantine": {
    "Root": "%PROGRAMDATA%/Muhafiz/Q",
    "Encrypt": false,
    "EncryptExtensions": [],
    "KeyPath": ""
  },

  "Events": {
    "Root": "%PROGRAMDATA%/Muhafiz/events",
    "RetentionDays": 30
  },

  "DnsAnomaly": {
    "Enabled": true,
    "IntervalSeconds": 30
  },

  "SelfProtection": {
    "Enabled": true,
    "HardenPaths": [
      "%PROGRAMDATA%/Muhafiz/Q",
      "%PROGRAMDATA%/Muhafiz/events"
    ]
  },

  "UpdateChannel": {
    "Enabled": true,
    "WatchPath": "%PROGRAMDATA%/Muhafiz/update",
    "IntervalSeconds": 30
  },

  "ProcessKiller": {
    "Enabled": true,
    "SoftKillTimeoutMs": 1500,
    "HardKill": true,
    "Exclusions": [ "explorer.exe", "svchost.exe", "dllhost.exe" ]
  },

  "Canary": {
    "Enabled": true,
    "DropPaths": [
      "%USERPROFILE%/Desktop",
      "%USERPROFILE%/Documents",
      "%USERPROFILE%/Downloads",
      "__BROWSER_PROFILES__"
    ],
    "Filenames": [
      "Passwords-Export.csv",
      "Login Data.bak",
      "Cookies.backup",
      "wallets.txt",
      "seed-phrase.txt"
    ],
    "ContentMarkers": [ "MUHAFIZ-CANARY", "DO-NOT-TOUCH" ],
    "AlertOnOpen": true,
    "ReseedHours": 24,
    "QuarantineOnHit": false
  },

  "Sandbox": {
    "Enabled": true,
    "Trigger": "OnQuarantine",
    "MaxParallel": 2,
    "CacheTtlMinutes": 1440,
    "AllowedExtensions": [ ".exe", ".dll", ".js", ".vbs", ".ps1", ".bat", ".zip", ".rar" ],

    "WindowsSandbox": {
      "Enabled": true,
      "TimeoutSeconds": 120,
      "MemoryMB": 2048,
      "Networking": "Disable"
    },

    "VirusTotal": {
      "Enabled": true,
      "ApiKey": "",
      "Mode": "HashOnly",
      "RateLimitPerMin": 4
    },

    "HybridAnalysis": {
      "Enabled": false,
      "ApiKey": "",
      "Environment": "windows10",
      "Mode": "HashOnly",
      "RateLimitPerMin": 3
    },

    "Privacy": {
      "AskBeforeUpload": false,
      "NeverUploadPaths": [
        "%USERPROFILE%\\Documents\\*",
        "%USERPROFILE%\\Desktop\\*.key"
      ],
      "AllowExtensions": [ ".exe", ".dll", ".js", ".vbs", ".ps1", ".zip", ".rar" ],
      "MaxSampleSizeMB": 32
    }
  }
}
